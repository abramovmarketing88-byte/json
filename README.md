# Разделитель чатов Telegram (JSON разбивка)

Веб-приложение без сервера: загружаете большой экспорт чата Telegram (`result.json`), указываете размер части в словах — получаете ZIP с текстовыми файлами `part_1.txt`, `part_2.txt`, …

- Обработка в браузере, файл никуда не отправляется.
- Потоковый разбор — подходит для очень больших JSON.

---

## Как запустить (максимально просто)

### Вариант 1: GitHub Pages (один раз настроил — открываешь по ссылке)

1. Залейте этот репозиторий на GitHub (или папку с `index.html` и `index.tsx` как корень репозитория).
2. В репозитории: **Settings** → **Pages**.
3. В блоке **Build and deployment** выберите **Source**: **Deploy from a branch**.
4. **Branch**: `main` (или `master`), папка **/ (root)**. Сохраните.
5. Через 1–2 минуты приложение откроется по адресу:
   ```text
   https://<ваш-логин>.github.io/<имя-репозитория>/
   ```
   **Для этого репозитория:**  
   **https://abramovmarketing88-byte.github.io/json/**

Дальше просто открываете эту ссылку в браузере — это и есть «максимально простой» запуск.

---

### Вариант 2: Локально на своём компьютере

Модули (`import`) не работают при открытии `index.html` двойным щелчком (`file://`). Нужен любой простой локальный сервер.

**Способ A — через Node.js (одна команда):**

```bash
npx serve .
```

В консоли появится что-то вроде `http://localhost:3000`. Откройте эту ссылку в браузере.

**Способ B — через Python:**

```bash
# Python 3
python -m http.server 8080
```

Откройте в браузере: **http://localhost:8080**

**Способ C — расширение для VS Code / Cursor:**  
Установите расширение «Live Server» и нажмите «Go Live» — откроется страница с приложением.

---

## Что нужно в репозитории для GitHub Pages

В корне (или в той папке, которую вы выбрали как источник для Pages) должен лежать **`index.html`** — приложение собрано в один файл, отдельный `index.tsx` для запуска не нужен.

---

## Использование

1. Откройте приложение (по ссылке GitHub Pages или через локальный сервер).
2. Перетащите файл `result.json` в зону загрузки или выберите его кнопкой.
3. При необходимости измените «Количество слов в одном файле» (по умолчанию 100 000).
4. Нажмите **«Начать обработку»**.
5. Дождитесь окончания и скачайте `split_result.zip` с файлами `part_1.txt`, `part_2.txt`, …

Файл обрабатывается только у вас в браузере и никуда не загружается.

---

## Режим с бэкендом (метрики, CSV/Excel/JSONL)

Для экспорта с метриками (отправитель, дата, реакции, reply_to), форматов CSV/Excel/JSONL и перекрытия блоков (overlap) используется Python-бэкенд и React-фронтенд.

### Структура проекта

```text
json/
├── backend/           # FastAPI
│   ├── processor.py   # TelegramMessage, парсинг, контекстные блоки, overlap
│   ├── exporters.py   # CSV, Excel, JSONL, TXT
│   ├── main.py        # API: /process, /preview
│   └── requirements.txt
├── frontend/          # React + Vite + Tailwind
│   ├── src/
│   │   ├── components/
│   │   │   ├── FileUploader.jsx
│   │   │   └── ExportSettings.jsx
│   │   └── App.jsx
│   └── package.json
├── shared/
│   └── schema.json   # Схема выходных данных
└── index.html        # Одностраничная версия (без бэкенда)
```

### Запуск бэкенда

```bash
cd backend
pip install -r requirements.txt
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

API: `http://127.0.0.1:8000` (документация: `/docs`).

### Запуск фронтенда (с прокси на бэкенд)

```bash
cd frontend
npm install
npm run dev
```

Откройте `http://localhost:5173`. Запросы к `/api/*` проксируются на бэкенд (порт 8000).

### Что умеет бэкенд

- **Форматы:** TXT (читаемый), CSV, JSONL (для ИИ/RAG), Excel.
- **Метрики:** дата, отправитель (ID, имя), реакции, ID ответа (reply_to). Включение/выключение в «Дополнительные настройки».
- **Разбиение:** по количеству слов с учётом границ сообщений; overlap — последние N сообщений предыдущего блока дублируются в начале следующего (для контекста ИИ).
- **Превью:** кнопка «Показать превью» — первые 5 сообщений с метриками в таблице перед полной выгрузкой.
